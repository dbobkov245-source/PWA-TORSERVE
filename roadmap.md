# üó∫Ô∏è PWA-TorServe ‚Äî –§–∏–Ω–∞–ª—å–Ω–∞—è –¥–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ —Ä–∞–∑–≤–∏—Ç–∏—è —Ç–æ—Ä—Ä–µ–Ω—Ç-–∞–≥—Ä–µ–≥–∞—Ü–∏–∏ (FINAL)

## üìå 0. –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞

**PWA-TorServe** ‚Äî self-hosted Node.js middleware –¥–ª—è –ø–æ–∏—Å–∫–∞, –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤ —Å PWA-–∫–ª–∏–µ–Ω—Ç–æ–º.

–ü—Ä–æ–µ–∫—Ç:
- –Ω–µ —Ö–æ—Å—Ç–∏—Ç –∫–æ–Ω—Ç–µ–Ω—Ç
- –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π —Ä–µ–ª–∏–∑
- –ø–µ—Ä–µ–¥–∞—ë—Ç magnet –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π streaming engine

–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:  
üëâ **—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, –∫–æ–Ω—Ç—Ä–æ–ª—å –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å**, –∞ –Ω–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ—Ö–≤–∞—Ç.

---

## üéØ 1. –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ü–µ–ª—å (North Star)

–ü–æ—Å—Ç—Ä–æ–∏—Ç—å **—É—Å—Ç–æ–π—á–∏–≤—É—é —Å–∏—Å—Ç–µ–º—É –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ —Ç–æ—Ä—Ä–µ–Ω—Ç-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤**, –≥–¥–µ:

- –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –Ω–µ –ª–æ–º–∞–µ—Ç core
- –ø–∞–¥–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Ç—Ä–µ–∫–µ—Ä–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–∏—Å—Ç–µ–º—É
- AutoDownloader –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–¥–Ω–æ–≥–æ API
- —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —É—Å–ª–æ–≤–∏—è—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- –∫–æ–¥ –æ—Å—Ç–∞—ë—Ç—Å—è —á–∏—Ç–∞–µ–º—ã–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º

---

## üß† 2. –£—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### 2.1 Core-–ø—Ä–∏–Ω—Ü–∏–ø—ã
- JavaScript-–ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∫–∞–∫ –æ—Å–Ω–æ–≤–∞
- –µ–¥–∏–Ω—ã–π `SearchResult`
- —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π Aggregator
- partial success –¥–æ–ø—É—Å—Ç–∏–º
- self-hosted first
- graceful degradation

### 2.2 –û—Å–æ–∑–Ω–∞–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –Ω–µ –∑–∞–º–µ–Ω—è—Ç—å Jackett
- –Ω–µ –≥–Ω–∞—Ç—å—Å—è –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç—Ä–µ–∫–µ—Ä–æ–≤
- –Ω–µ —Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ç–µ–≤–æ–π ‚Äú–∫–æ–º–±–∞–π–Ω‚Äù
- –Ω–µ –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö –æ–±–ª–∞—á–Ω—ã—Ö API

---

## üåê 3. –≠—Ç–∞–ø 1 ‚Äî Unified Network Layer

### –¶–µ–ª—å
–°–¥–µ–ª–∞—Ç—å —Å–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —É—Å—Ç–æ–π—á–∏–≤—ã–º –∫:
- DPI
- Cloudflare / anti-bot
- –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º –∑–µ—Ä–∫–∞–ª–∞–º

### –°–æ—Å—Ç–∞–≤
- –µ–¥–∏–Ω—ã–π HTTP-–∫–ª–∏–µ–Ω—Ç
- browser-like TLS / headers
- retries + —Ç–∞–π–º–∞—É—Ç—ã
- mirror failover
- rate limiting per provider
- –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –ü—Ä–∏–Ω—Ü–∏–ø—ã
- direct —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –ø—É—Ç—å
- fallback-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ–∑–º–æ–∂–Ω—ã
- –ø—Ä–æ–∫—Å–∏ / Tor **–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã**, –Ω–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º—ã

---

## üîå 4. –≠—Ç–∞–ø 2 ‚Äî Unified Provider Architecture

### –¶–µ–ª—å
–£–±—Ä–∞—Ç—å —Ö–∞—Ä–¥–∫–æ–¥ –∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏.

### –ú–æ–¥–µ–ª—å
- `BaseProvider`
- `ProviderManager`
- –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π `SearchResult`

–ö–∞–∂–¥—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä:
- –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ –∏ —Å–µ—Ç—å
- —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç
- –Ω–µ –∑–Ω–∞–µ—Ç –æ UI –∏ AutoDownloader

---

## üìö 5. –≠—Ç–∞–ø 3 ‚Äî –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π –Ω–∞–±–æ—Ä
- **Jacred** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä
- **RuTracker** ‚Äî –ø—Ä–∏–≤–∞—Ç–Ω—ã–π RU-–∏—Å—Ç–æ—á–Ω–∏–∫
- **Rutor** ‚Äî –ø—É–±–ª–∏—á–Ω—ã–π –±—ã—Å—Ç—Ä—ã–π
- **TorLook** ‚Äî fallback

### –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- mirror rotation
- rate limiting (–æ—Å–æ–±–µ–Ω–Ω–æ RuTracker)
- persisted cookies
- –º–∏–Ω–∏–º—É–º –ª–æ–≥–∏–Ω–æ–≤

---

## üß† 6. –≠—Ç–∞–ø 4 ‚Äî Aggregator + Ranking

### Aggregator
- –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- `Promise.allSettled`
- timeout per provider
- –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ infohash
- partial success

### Ranking
- —Å–∏–¥—ã
- —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
- —è–∑—ã–∫
- –∏—Å—Ç–æ—á–Ω–∏–∫
- sanity-check –ø–æ —Ä–∞–∑–º–µ—Ä—É
- —É—á—ë—Ç REPACK / PROPER

> –í–∞–∂–Ω–æ: –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –ª—É—á—à–µ–≥–æ —Ä–µ–ª–∏–∑–∞ ‚Äî **–æ–±—â–∞—è**, –Ω–µ —Ç–æ–ª—å–∫–æ –¥–ª—è AutoDownloader.

---

## üì• 7. –≠—Ç–∞–ø 5 ‚Äî AutoDownloader v2

### –¶–µ–ª—å
–°–¥–µ–ª–∞—Ç—å –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –æ—Ç –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.

### –ò–∑–º–µ–Ω–µ–Ω–∏—è
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Aggregator
- –≤—ã–±–æ—Ä best candidate
- –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è
- —Å—Ç—Ä–æ–≥–æ 1 —Ç–æ—Ä—Ä–µ–Ω—Ç –Ω–∞ —ç–ø–∏–∑–æ–¥
- –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å REPACK / BATCH

---

## üõ°Ô∏è 8. –≠—Ç–∞–ø 6 ‚Äî Hardening

- provider health checks
- circuit breaker per provider
- short-lived search cache (5‚Äì10 –º–∏–Ω)
- persisted sessions (RuTracker)
- –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

# üîÆ 9. –ü–ª–∞–Ω –Ω–∞ –±—É–¥—É—â–µ–µ (Future considerations)

> –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª **–ù–ï —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º roadmap**.  
> –û–Ω –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω, —á—Ç–æ–±—ã:
> - –Ω–µ –∑–∞–±—ã—Ç—å –æ–±—Å—É–∂–¥—ë–Ω–Ω—ã–µ –∏–¥–µ–∏
> - –ø–æ–Ω–∏–º–∞—Ç—å, *–∑–∞—á–µ–º* –æ–Ω–∏ –º–æ–≥—É—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è
> - –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∏–º–ø—É–ª—å—Å–∏–≤–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –ø–æ–∑–∂–µ

---

## 9.1 RSS Providers

**–ß—Ç–æ —ç—Ç–æ:**  
–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ RSS –≤–º–µ—Å—Ç–æ HTML-–ø–æ–∏—Å–∫–∞.

**–ó–∞—á–µ–º:**  
- –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ç—Ä–µ–∫–µ—Ä—ã —á–∞—Å—Ç–æ —Ä–∞–∑—Ä–µ—à–∞—é—Ç —Ç–æ–ª—å–∫–æ RSS
- –º–µ–Ω—å—à–µ –±–∞–Ω–æ–≤ –∏ –∫–∞–ø—á
- –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è AutoDownloader

**–ü–æ—á–µ–º—É –Ω–µ core:**  
- –Ω–µ –Ω—É–∂–µ–Ω –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–≤–µ—Ä—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ Aggregator

---

## 9.2 YAML / Cardigann Providers

**–ß—Ç–æ —ç—Ç–æ:**  
–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è YAML-–æ–ø–∏—Å–∞–Ω–∏–π —Ç—Ä–µ–∫–µ—Ä–æ–≤ (–ø–æ —Ç–∏–ø—É Cardigann).

**–ó–∞—á–µ–º:**  
- –±—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö —Ç—Ä–µ–∫–µ—Ä–æ–≤
- –ø—Ä–∞–≤–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è JS-–∫–æ–¥–∞

**–ü–æ—á–µ–º—É –Ω–µ core:**  
- YAML –ø–ª–æ—Ö–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:
  - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  - –∫–∞–ø—á–∏
  - —Å–ª–æ–∂–Ω—ã—Ö retry-–ª–æ–≥–∏–∫
- —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏

**–ü–æ–∑–∏—Ü–∏—è:**  
YAML ‚Äî *–æ–¥–∏–Ω –∏–∑ —Ç–∏–ø–æ–≤ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤*, –∞ –Ω–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –æ—Å–Ω–æ–≤–∞.

---

## 9.3 Captcha Handling

**–ß—Ç–æ —ç—Ç–æ:**  
–ü–µ—Ä–µ—Ö–≤–∞—Ç –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–ø—á–∏ (RuTracker –∏ –¥—Ä.).

**–ó–∞—á–µ–º:**  
- –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ç—Ä–µ–∫–µ—Ä—ã —Ç—Ä–µ–±—É—é—Ç –∫–∞–ø—á—É
- –±–µ–∑ —ç—Ç–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

**–§–æ—Ä–º–∞:**  
- semi-manual (–ø–æ–∫–∞–∑ –≤ UI)
- –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ü–æ—á–µ–º—É –Ω–µ core:**  
- provider-specific edge-case
- –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –≤ —Ü–µ–ª–æ–º

---

## 9.4 Jackett / Torznab API

**–ß—Ç–æ —ç—Ç–æ:**  
–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Sonarr / Radarr / Bazarr.

**–ó–∞—á–µ–º:**  
- –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–µ–π —ç–∫–æ—Å–∏—Å—Ç–µ–º–æ–π
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PWA-TorServe –∫–∞–∫ backend

**–ü–æ—á–µ–º—É –Ω–µ core:**  
- –Ω–µ –Ω—É–∂–µ–Ω –¥–ª—è UI –∏ AutoDownloader
- –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏

---

## 9.5 Proxy / Tor / Headless Browser

**–ß—Ç–æ —ç—Ç–æ:**  
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.

**–ó–∞—á–µ–º:**  
- –∫—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã

**–ü–æ—á–µ–º—É –Ω–µ core:**  
- —Å–ª–æ–∂–Ω–æ—Å—Ç—å
- –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
- –≤—ã—Å–æ–∫–∏–π overhead

**–ü–æ–∑–∏—Ü–∏—è:**  
Last-resort, experimental.

---

## üö´ 10. –Ø–≤–Ω—ã–µ –Ω–µ-—Ü–µ–ª–∏ (–¥–∞–∂–µ –≤ –±—É–¥—É—â–µ–º)

- –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ –≤ Jackett-replacement
- –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ—Ç–µ–Ω —Ç—Ä–µ–∫–µ—Ä–æ–≤ –ª—é–±–æ–π —Ü–µ–Ω–æ–π
- –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –æ–±—Ö–æ–¥ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ ‚Äú–ª—é–±–æ–π —Ü–µ–Ω–æ–π‚Äù
- —É—Ö–æ–¥ –æ—Ç self-hosted –º–æ–¥–µ–ª–∏

---

## ‚úÖ 11. Definition of Done (–∏—Ç–æ–≥–æ–≤—ã–π)

- –Ω–æ–≤—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –±–µ–∑ –ø—Ä–∞–≤–æ–∫ core
- —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —á–∞—Å—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- AutoDownloader –Ω–µ –¥—É–±–ª–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏
- –Ω–µ—Ç –∂—ë—Å—Ç–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–¥–Ω–æ–≥–æ API
- –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ—Å—Ç–∞—ë—Ç—Å—è —á–∏—Ç–∞–µ–º–æ–π

