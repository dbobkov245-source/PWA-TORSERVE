# ‚öîÔ∏è –•—Ä–æ–Ω–∏–∫–∏ –ë–∏—Ç–≤—ã –∑–∞ –ü–æ—Å—Ç–µ—Ä—ã: TMDB vs ISP

–≠—Ç–æ –¥–µ—Ç–∞–ª—å–Ω—ã–π –ª–æ–≥ –Ω–∞—à–µ–π –≤–æ–π–Ω—ã —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∑–∞ –ø—Ä–∞–≤–æ –≤–∏–¥–µ—Ç—å –æ–±–ª–æ–∂–∫–∏ —Ñ–∏–ª—å–º–æ–≤.

## üõë –ü—Ä–æ–ª–æ–≥: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–µ (Android TV) –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏.
**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ `api.themoviedb.org` –∏ `image.tmdb.org` –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º (–†–ö–ù).
**–ü–µ—Ä–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** –ú—ã —Ä–µ—à–∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å **Server-Side Proxy** –Ω–∞ Node.js (NAS), —á—Ç–æ–±—ã —Ç–µ–ª–µ–≤–∏–∑–æ—Ä –æ–±—Ä–∞—â–∞–ª—Å—è –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É, –∞ —Å–µ—Ä–≤–µ—Ä —É–∂–µ —à–µ–ª –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.

---

## üé≠ –ê–∫—Ç 1: –ó–µ—Ä–∫–∞–ª—å–Ω—ã–µ –í–æ–π–Ω—ã
–°–µ—Ä–≤–µ—Ä (NAS) —Ç–æ–∂–µ –æ–∫–∞–∑–∞–ª—Å—è –ø–æ–¥ –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞. –ú—ã –Ω–∞—á–∞–ª–∏ –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å "–ø–∏—Ä–∞—Ç—Å–∫–∏–µ" –∑–µ—Ä–∫–∞–ª–∞.

### –ü–æ–ø—ã—Ç–∫–∞ ‚Ññ1: `apitmdb.cub.watch`
*   **–ò–¥–µ—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω–æ–µ –∑–µ—Ä–∫–∞–ª–æ –æ—Ç —Å–µ—Ä–≤–∏—Å–∞ Lampa.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `JSON Parse Error: <!doctype html>`.
*   **–ê–Ω–∞–ª–∏–∑:** –ó–µ—Ä–∫–∞–ª–æ –∑–∞—â–∏—â–µ–Ω–æ Cloudflare –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π ("Checking your browser"), –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–¥–∞–µ—Ç HTML-–∫–∞–ø—á—É –≤–º–µ—Å—Ç–æ JSON-–æ—Ç–≤–µ—Ç–∞ –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å —Å–µ—Ä–≤–µ—Ä–∞.

### –ü–æ–ø—ã—Ç–∫–∞ ‚Ññ2: `api.tmdb.best`
*   **–ò–¥–µ—è:** –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –∑–µ—Ä–∫–∞–ª–æ.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ. –°–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç HTML —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –æ—à–∏–±–∫–æ–π –¥–æ—Å—Ç—É–ø–∞ –∏–ª–∏ –∑–∞–≥–ª—É—à–∫—É —Ö–æ—Å—Ç–∏–Ω–≥–∞.

### –ü–æ–ø—ã—Ç–∫–∞ ‚Ññ3: `api.1080.club`
*   **–ò–¥–µ—è:** "–ñ–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω–æ–µ" –∑–µ—Ä–∫–∞–ª–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ –º–Ω–æ–≥–∏–º–∏ –±–∞–ª–∞–Ω—Å–µ—Ä–∞–º–∏.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `fetch failed` / `UDP Timeout`. –ü—Ä–æ–≤–∞–π–¥–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç IP-–∞–¥—Ä–µ—Å–∞ —ç—Ç–æ–≥–æ –∑–µ—Ä–∫–∞–ª–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ DNS –∏–ª–∏ DPI.
*   **–•–∞–∫–∏:** –ú—ã –ø—Ä–æ–±–æ–≤–∞–ª–∏ –æ—Ç–∫–ª—é—á–∞—Ç—å SSL-–ø—Ä–æ–≤–µ—Ä–∫—É (`NODE_TLS_REJECT_UNAUTHORIZED = '0'`), –º–µ–Ω—è—Ç—å `User-Agent` –Ω–∞ Chrome/Windows, –¥–æ–±–∞–≤–ª—è—Ç—å `Referer`. –ë–µ—Å–ø–æ–ª–µ–∑–Ω–æ.

---

## üõ† –ê–∫—Ç 2: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ò–∑–æ—â—Ä–µ–Ω–∏—è

–ö–æ–≥–¥–∞ –ø—Ä—è–º—ã–µ –∑–µ—Ä–∫–∞–ª–∞ –ø–∞–ª–∏, –º—ã –ø–µ—Ä–µ—à–ª–∏ –∫ "—Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é".

### –ü–æ–ø—ã—Ç–∫–∞ ‚Ññ4: Google Translate Hack ü•ã
*   **–ò–¥–µ—è:** –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫ Google (`api-themoviedb-org.translate.goog`). –¢—Ä–∞—Ñ–∏–∫ –≤—ã–≥–ª—è–¥–∏—Ç –¥–ª—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∫–∞–∫ –ª–µ–≥–∞–ª—å–Ω—ã–π –ø–æ—Ö–æ–¥ –≤ Google.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** **–û—à–∏–±–∫–∞ 408 (Timeout)** –∏ HTML —Å —Ç–µ–∫—Å—Ç–æ–º "Can't translate this page".
*   **–ü—Ä–∏—á–∏–Ω–∞:** Google —Ä–∞—Å–ø–æ–∑–Ω–∞–ª, —á—Ç–æ –º—ã –≥–æ–Ω—è–µ–º —á–µ—Ä–µ–∑ –Ω–µ–≥–æ API-–∑–∞–ø—Ä–æ—Å—ã (JSON), –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª —ç—Ç–æ—Ç —Ç—Ä—é–∫ –¥–ª—è –Ω–∞—à–µ–≥–æ IP.

### –ü–æ–ø—ã—Ç–∫–∞ ‚Ññ5: `corsproxy.io`
*   **–ò–¥–µ—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π CORS-–ø—Ä–æ–∫—Å–∏.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `Cloudflare Block`. –°–µ—Ä–≤–∏—Å `corsproxy` —Å–∞–º –ø–æ —Å–µ–±–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ TMDB (—Ü–µ–ª–µ–≤–æ–π —Å–∞–π—Ç) –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã, –ø—Ä–∏—Ö–æ–¥—è—â–∏–µ –æ—Ç —ç—Ç–æ–≥–æ –ø—Ä–æ–∫—Å–∏, –ª–∏–±–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–∞–º –ø—Ä–æ–∫—Å–∏.

### –ü–æ–ø—ã—Ç–∫–∞ ‚Ññ6: –ü—É–±–ª–∏—á–Ω—ã–µ CDN (`allorigins.win` + `wsrv.nl`)
*   **–ò–¥–µ—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `allorigins` –¥–ª—è JSON –∏ `wsrv.nl` (Image Proxy) –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
    *   –ü–æ–∏—Å–∫: –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–ª, –Ω–æ –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ.
    *   –ö–∞—Ä—Ç–∏–Ω–∫–∏: –û—à–∏–±–∫–∏ 500.
    *   **–ò—Ç–æ–≥:** –°–µ—Ä–≤–µ—Ä –Ω–∞—á–∞–ª "–∑–∞—Ö–ª–µ–±—ã–≤–∞—Ç—å—Å—è" —Ç–∞–π–º–∞—É—Ç–∞–º–∏, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ –¢–í —Å—Ç–∞–ª —Ç–æ—Ä–º–æ–∑–∏—Ç—å (—Ñ—Ä–∏–∑—ã –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ), —Ç–∞–∫ –∫–∞–∫ –æ–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –∑–∞–Ω–∏–º–∞–ª–æ —Å–µ–∫—É–Ω–¥—ã.

---

## üè≥Ô∏è –≠–ø–∏–ª–æ–≥ (–í—Ä–µ–º–µ–Ω–Ω—ã–π): Offline Mode
–ú—ã –ø–æ–Ω—è–ª–∏, —á—Ç–æ –±–µ–∑ VPN –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ä–æ—É—Ç–µ—Ä–∞/NAS –ø—Ä–æ–±–∏—Ç—å —ç—Ç—É —Å—Ç–µ–Ω—É **—Å–µ—Ä–≤–µ—Ä–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏** –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ. –ú—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏–ª–∏ –ø—Ä–æ–∫—Å–∏ (404 stubs) –∏ —Å–¥–µ–ª–∞–ª–∏ –∫—Ä–∞—Å–∏–≤—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã, —á—Ç–æ–±—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å "–ª–µ—Ç–∞–ª".

---

## üöÄ –ê–∫—Ç 3: –í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ (Full Client Strategy)

–ü–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Lampa –º—ã –ø–æ–Ω—è–ª–∏ –æ—à–∏–±–∫—É: **–º—ã –ø—ã—Ç–∞–ª–∏—Å—å –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ –°–µ—Ä–≤–µ—Ä (NAS)**, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–æ–π –∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–µ—Ç–∏, –Ω–æ –º–µ–Ω–µ–µ "–≥–∏–±–æ–∫", —á–µ–º –±—Ä–∞—É–∑–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞.

### –°–º–µ–Ω–∞ –ø–∞—Ä–∞–¥–∏–≥–º—ã:
–ú—ã –ø–µ—Ä–µ–Ω–µ—Å–ª–∏ –í–°–Æ –ª–æ–≥–∏–∫—É –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –Ω–∞ **–ö–ª–∏–µ–Ω—Ç (–¢–í)**, –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–∏–≤ –ª–æ–∫–∞–ª—å–Ω—ã–π Node.js —Å–µ—Ä–≤–µ—Ä –∏–∑ —Ü–µ–ø–æ—á–∫–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å—Ç–µ—Ä–æ–≤.

### –ü–æ–±–µ–¥–Ω–∞—è —Å—Ö–µ–º–∞:
1.  **–ü–æ–∏—Å–∫ (Metadata):** –ö–ª–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `api.allorigins.win` (CORS-Proxy).
    *   *–ó–∞—á–µ–º:* –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å JSON —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ñ–∏–ª—å–º–µ (title, poster_path).
    *   *–ü–æ—á–µ–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç:* –¢–µ–ª–µ–≤–∏–∑–æ—Ä –∏–¥–µ—Ç –Ω–∞ `allorigins.win` (–∫–æ—Ç–æ—Ä—ã–π –æ–±—ã—á–Ω–æ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è), –∞ —Ç–æ—Ç —É–∂–µ –∏–¥–µ—Ç –≤ TMDB –∏–∑ "—Å–≤–æ–±–æ–¥–Ω–æ–π –∑–æ–Ω—ã".
2.  **–ö–∞—Ä—Ç–∏–Ω–∫–∞ (Image):** –ö–ª–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `wsrv.nl` (Image CDN).
    *   *–ó–∞—á–µ–º:* –ü–æ–ª—É—á–∏—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫ –∫–∞—Ä—Ç–∏–Ω–∫–∏.
    *   *Warum —Ä–∞–±–æ—Ç–∞–µ—Ç:* –¢—Ä–∞—Ñ–∏–∫ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –æ–±—ã—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ CDN, –∞ –Ω–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω–æ–º—É `tmdb.org`.
3.  **Fallback (–°—Ç—Ä–∞—Ö–æ–≤–∫–∞):**
    *   –ï—Å–ª–∏ –¥–∞–∂–µ —ç—Ç–∏ –º–µ—Ç–æ–¥—ã –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –æ—Ç–≤–∞–ª–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞), –∫–ª–∏–µ–Ω—Ç **–º–≥–Ω–æ–≤–µ–Ω–Ω–æ** —Ä–∏—Å—É–µ—Ç –Ω–∞—à–∏ –∫—Ä–∞—Å–∏–≤—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã.

### –ò—Ç–æ–≥ –ë–∏—Ç–≤—ã: üèÜ WIN
*   **–ü–æ—Å—Ç–µ—Ä—ã:** –ï–°–¢–¨ (–≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏).
*   **–°–∫–æ—Ä–æ—Å—Ç—å:** –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø (—Å–µ—Ä–≤–µ—Ä –Ω–µ —Ç—É–ø–∏—Ç, –∫–ª–∏–µ–Ω—Ç –≥—Ä—É–∑–∏—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ).
*   **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** 100% (Offline Fallback –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å—Ç—Ä–∞–∂–µ).

---

## üîç –ê–∫—Ç 4: –ì–ª—É–±–∏–Ω–Ω–∞—è –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–î–µ–∫–∞–±—Ä—å 2024)

### –°–∏–º–ø—Ç–æ–º—ã:
–ü–æ—Å—Ç–µ—Ä—ã –ø–µ—Ä–µ—Å—Ç–∞–ª–∏ –≥—Ä—É–∑–∏—Ç—å—Å—è –¥–∞–∂–µ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏. –î–æ–±–∞–≤–∏–ª–∏ –∫–Ω–æ–ø–∫—É "üß™ –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å—Ç–µ—Ä–æ–≤" –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞:
```
üß™ –¢–µ—Å—Ç –ø–æ—Å—Ç–µ—Ä–∞: "The Beekeeper"

1Ô∏è‚É£ CapacitorHttp: ‚ùå –û—à–∏–±–∫–∞: Failed to connect to api.themoviedb.org/127.0.0.1:443
2Ô∏è‚É£ corsproxy.io: ‚ùå HTTP 403
```

### –î–∏–∞–≥–Ω–æ–∑: üö® DNS Poisoning
–ü—Ä–æ–≤–∞–π–¥–µ—Ä –ø–æ–¥–º–µ–Ω—è–µ—Ç DNS ‚Äî `api.themoviedb.org` —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –≤ `127.0.0.1` (localhost)!
–≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ ‚Äî —ç—Ç–æ **–æ—Ç—Ä–∞–≤–ª–µ–Ω–∏–µ DNS-–∫—ç—à–∞**.

### –ö–∞–∫ Lampa —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É:
–ò–∑—É—á–∏–ª–∏ –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ Lampa ‚Äî –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **DNS-over-HTTPS (Quad9)**:
```kotlin
val dns = DnsOverHttps.Builder()
    .url("https://dns.quad9.net/dns-query")
    .bootstrapDnsHosts(InetAddress.getByName("9.9.9.9"))
    .build()
```

### –ù–∞—à–∏ —Ä–µ—à–µ–Ω–∏—è:

#### 1Ô∏è‚É£ VPN ‚úÖ
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –†–∞–±–æ—Ç–∞–µ—Ç! –° VPN —Ç–µ—Å—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
```
1Ô∏è‚É£ CapacitorHttp: ‚úÖ –ù–∞–π–¥–µ–Ω–æ: –ü—á–µ–ª–æ–≤–æ–¥
2Ô∏è‚É£ corsproxy.io: ‚úÖ –ù–∞–π–¥–µ–Ω–æ: –ü—á–µ–ª–æ–≤–æ–¥
```

#### 2Ô∏è‚É£ –°–º–µ–Ω–∞ DNS –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å DNS –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ –∏–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:
- **Cloudflare:** `1.1.1.1`
- **Google:** `8.8.8.8`
- **Quad9:** `9.9.9.9`

#### 3Ô∏è‚É£ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π TMDB Proxy (–∫–∞–∫ –≤ Lampa)
–î–æ–±–∞–≤–∏–ª–∏ –≤ Settings ‚Üí Advanced ‚Üí **TMDB API Proxy**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–∫–∞–∑–∞—Ç—å —Å–≤–æ–π –ø—Ä–æ–∫—Å–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

---

## üèÜ –ê–∫—Ç 5: –§–∏–Ω–∞–ª—å–Ω–∞—è –ü–æ–±–µ–¥–∞ (–î–µ–∫–∞–±—Ä—å 2024)

### –ò–∑—É—á–µ–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–æ–≤ Lampa
–ù–∞—à–ª–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ Lampa –≥–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:
- `tmdb_proxy.js` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `apn-latest.onrender.com`
- `kp_source.js` ‚Äî –ö–∏–Ω–æ–ø–æ–∏—Å–∫ API –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ TMDB
- `cloudflare_worker.js` ‚Äî –∫–æ–¥ –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è —Å–≤–æ–µ–≥–æ –ø—Ä–æ–∫—Å–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ—à–µ–Ω–∏–π
1. **Lampa Proxy** (`apn-latest.onrender.com`) ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback
2. **–ö–∏–Ω–æ–ø–æ–∏—Å–∫ API** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π fallback –µ—Å–ª–∏ TMDB –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
3. **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è Cloudflare Worker** ‚Äî —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏

### –§–∏–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ fetchPoster:
```
1Ô∏è‚É£ –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø—Ä–æ–∫—Å–∏ (–µ—Å–ª–∏ –∑–∞–¥–∞–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö)
      ‚Üì (fallback)
2Ô∏è‚É£ Lampa Proxy (apn-latest.onrender.com) ‚Üê –†–ê–ë–û–¢–ê–ï–¢ –ë–ï–ó VPN!
      ‚Üì (fallback)
3Ô∏è‚É£ CapacitorHttp –∫ TMDB –Ω–∞–ø—Ä—è–º—É—é (—Ç—Ä–µ–±—É–µ—Ç VPN/DNS)
      ‚Üì (fallback)  
4Ô∏è‚É£ corsproxy.io (CORS –ø—Ä–æ–∫—Å–∏ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞)
      ‚Üì (fallback)
5Ô∏è‚É£ –ö–∏–Ω–æ–ø–æ–∏—Å–∫ API (kinopoiskapiunofficial.tech) ‚Üê –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ê TMDB
      ‚Üì (fallback)
6Ô∏è‚É£ –ö—Ä–∞—Å–∏–≤—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã üé®
```

### –ò—Ç–æ–≥: üèÜ VICTORY!
*   **–ü–æ—Å—Ç–µ—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ë–ï–ó VPN** —á–µ—Ä–µ–∑ Lampa Proxy
*   **–ü–æ—Å—Ç–µ—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –° VPN** –Ω–∞–ø—Ä—è–º—É—é
*   **5-—É—Ä–æ–≤–Ω–µ–≤—ã–π fallback** ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å
*   **–ö–∏–Ω–æ–ø–æ–∏—Å–∫ –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞** ‚Äî –µ—Å–ª–∏ TMDB –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–±–ª–æ–∫–∏—Ä—É—é—Ç
*   **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Å–≤–æ–µ–≥–æ Worker** ‚Äî –Ω–∞ —Å–ª—É—á–∞–π –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —á—É–∂–∏—Ö –ø—Ä–æ–∫—Å–∏

---

## üîê –ê–∫—Ç 6: –°–µ—Ä–≤–µ—Ä–Ω—ã–π DoH (–î–µ–∫–∞–±—Ä—å 2024)

### –ü—Ä–æ–±–ª–µ–º–∞
Lampa Proxy –Ω–∞ Render.com "–∑–∞—Å—ã–ø–∞–µ—Ç" –ø—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –≤—ã–∑—ã–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∏ cold start.
–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π fallback —Ä–∞–±–æ—Ç–∞–ª, –Ω–æ –º—ã —Ä–µ—à–∏–ª–∏ —É—Å–∏–ª–∏—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—É—é —á–∞—Å—Ç—å.

### –†–µ—à–µ–Ω–∏–µ: DNS-over-HTTPS –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `server/utils/doh.js`:

```javascript
// –†–µ–∑–æ–ª–≤–∏–º IP —á–µ—Ä–µ–∑ Cloudflare DoH
const DOH_PROVIDER = 'https://cloudflare-dns.com/dns-query';

async function resolveIP(hostname) {
    const response = await fetch(DOH_PROVIDER, {
        params: { name: hostname, type: 'A' },
        headers: { 'Accept': 'application/dns-json' }
    });
    // –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 10 –º–∏–Ω—É—Ç
    return response.Answer.find(r => r.type === 1)?.data;
}

export async function smartFetch(url) {
    const ip = await resolveIP(new URL(url).hostname);
    // –û–±—Ö–æ–¥ DNS poisoning: –∏–¥—ë–º –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ IP —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º Host –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
    return fetch(url.replace(hostname, ip), { headers: { Host: hostname } });
}
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–í `server/index.js` TMDB —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç `smartFetch`:

```javascript
import { smartFetch } from './utils/doh.js'

app.get('/api/tmdb/search', async (req, res) => {
    const response = await smartFetch(`https://api.themoviedb.org/3/search/multi?...`)
    res.json(response.data)
})
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **Client Warmup** ‚Äî –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è HEAD –∑–∞–ø—Ä–æ—Å –∫ `apn-latest.onrender.com/ping` –¥–ª—è "–ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è" –ø—Ä–æ–∫—Å–∏
1.  **Client Warmup** ‚Äî –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è HEAD –∑–∞–ø—Ä–æ—Å –∫ `apn-latest.onrender.com/ping` –¥–ª—è "–ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è" –ø—Ä–æ–∫—Å–∏

2.  **–ë–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** ‚Äî DoH –º–æ–¥—É–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Node.js `fetch` (Node 18+), –Ω–µ —Ç—Ä–µ–±—É–µ—Ç axios

### –ò—Ç–æ–≥
- ‚úÖ –°–µ—Ä–≤–µ—Ä –æ–±—Ö–æ–¥–∏—Ç DNS poisoning —á–µ—Ä–µ–∑ Cloudflare DoH
- ‚úÖ –ö–ª–∏–µ–Ω—Ç ¬´–ø—Ä–æ–≥—Ä–µ–≤–∞–µ—Ç¬ª –≤–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ VPN –∏ –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö npm-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

## üßπ –ê–∫—Ç 7: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–î–µ–∫–∞–±—Ä—å 2024)

### –ü—Ä–æ–±–ª–µ–º–∞
`App.jsx` —Ä–∞–∑—Ä–æ—Å—Å—è –¥–æ **1223 —Å—Ç—Ä–æ–∫** ‚Äî —Å–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å.

### –†–µ—à–µ–Ω–∏–µ: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–†–∞–∑–±–∏–ª–∏ –º–æ–Ω–æ–ª–∏—Ç –Ω–∞ –º–æ–¥—É–ª–∏:

```
client/src/
‚îú‚îÄ‚îÄ App.jsx                    (622 —Å—Ç—Ä–æ–∫–∏, –±—ã–ª–æ 1223)
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ Poster.jsx            (226) ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ —Å –ø–æ—Å—Ç–µ—Ä–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ SettingsPanel.jsx     (172) ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–µ–µ—Ä–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ TorrentModal.jsx      (117) ‚Äî –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ StatusBanners.jsx     (108) ‚Äî –±–∞–Ω–Ω–µ—Ä—ã –æ—à–∏–±–æ–∫
‚îÇ   ‚îî‚îÄ‚îÄ SearchPanel.jsx       (83)  ‚Äî –ø–æ–∏—Å–∫ –ø–æ RuTracker
‚îî‚îÄ‚îÄ utils/
    ‚îî‚îÄ‚îÄ helpers.js            (96)  ‚Äî cleanTitle, formatSize, formatSpeed
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ 49%

---

## ‚ö° –ê–∫—Ç 8: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ (–î–µ–∫–∞–±—Ä—å 2024)

### –¢–∏–ø–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã TV-—Å—Ç—Ä–∏–º–∏–Ω–≥–∞
- ‚ùå –î–æ–ª–≥–∏–π —Å—Ç–∞—Ä—Ç (buffering)
- ‚ùå –ó–∞—Ç—ã–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–º–æ—Ç–∫–µ
- ‚ùå –°–∫–∞—á–∏–≤–∞–µ—Ç—Å—è ¬´–Ω–µ —Ç–æ—Ç¬ª –∫—É—Å–æ–∫

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

#### 1Ô∏è‚É£ –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π Piece Prioritization
```javascript
// –ë—ã–ª–æ: 15MB –∏–ª–∏ 5%
// –°—Ç–∞–ª–æ: 50MB –∏–ª–∏ 10%
const priorityBytes = Math.min(file.length * 0.1, 50 * 1024 * 1024)
```

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ—Ä—Ä–µ–Ω—Ç–∞ **—Å—Ä–∞–∑—É** –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∏–º –ø–µ—Ä–≤—ã–π –≤–∏–¥–µ–æ—Ñ–∞–π–ª:
```javascript
// –ê–≤—Ç–æ-–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–µ—Ä–≤–æ–≥–æ –≤–∏–¥–µ–æ
if (firstVideoIdx >= 0) {
    prioritizeFileInternal(engine, firstVideoIdx)
}
```

#### 2Ô∏è‚É£ Readahead –ø—Ä–∏ –ø–µ—Ä–µ–º–æ—Ç–∫–µ
–ü—Ä–∏ –∫–∞–∂–¥–æ–º Range-–∑–∞–ø—Ä–æ—Å–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∏–º –∫—É—Å–∫–∏ –æ—Ç –ø–æ–∑–∏—Ü–∏–∏ seek:
```javascript
// –í /stream/:infoHash/:fileIndex
readahead(infoHash, parseInt(fileIndex, 10), start)
```

–õ–æ–≥:
```
[Readahead] Seeking to byte 81197027701 in file 0
[Priority] File 0: pieces 19358-19358 (13 pieces, ~50MB)
```

#### 3Ô∏è‚É£ Keep-Alive (Frozen Torrents)
–í–º–µ—Å—Ç–æ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è ‚Äî ¬´–∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ–º¬ª —Ç–æ—Ä—Ä–µ–Ω—Ç –Ω–∞ 30 –º–∏–Ω—É—Ç:
```javascript
// –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏
frozenTorrents.set(infoHash, { engine, magnetURI, frozenAt: Date.now() })

// –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç!
const frozen = frozenTorrents.get(hash)
engines.set(magnetURI, frozen.engine)
```

### –ò—Ç–æ–≥
- ‚úÖ –°—Ç–∞—Ä—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è: **< 3 —Å–µ–∫—É–Ω–¥—ã**
- ‚úÖ –ü–µ—Ä–µ–º–æ—Ç–∫–∞: **–º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è** (readahead)
- ‚úÖ –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ: **instant** (keep-alive)

---

## üåê –ê–∫—Ç 9: –õ–∏—á–Ω—ã–π Cloudflare Worker (–î–µ–∫–∞–±—Ä—å 2024)

### –î–µ–ø–ª–æ–π —Å–≤–æ–µ–≥–æ CORS-–ø—Ä–æ–∫—Å–∏
–°–æ–∑–¥–∞–Ω –∏ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –ª–∏—á–Ω—ã–π Cloudflare Worker –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ TMDB.

**URL:** `https://super-sea-46c7.*.workers.dev`

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
–î–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ **–ø–µ—Ä–≤—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç** –≤ fetchPoster:
```javascript
// 1Ô∏è‚É£ Custom Cloudflare Worker (–≤–∞—à –ª–∏—á–Ω—ã–π –ø—Ä–æ–∫—Å–∏)
if (!result && CUSTOM_PROXY) {
    const proxyUrl = `${CUSTOM_PROXY}/api.themoviedb.org/3/search/multi?...`
    // ...
}
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```env
# –í .env (–∫–ª–∏–µ–Ω—Ç, –Ω–∞ —ç—Ç–∞–ø–µ —Å–±–æ—Ä–∫–∏)
VITE_TMDB_PROXY_URL=https://your-worker.workers.dev
```

### –ò—Ç–æ–≥
- ‚úÖ –õ–∏—á–Ω—ã–π –ø—Ä–æ–∫—Å–∏ —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é
- ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏–º –æ—Ç —á—É–∂–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ 100 000 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ

---

## üì¶ –ê–∫—Ç 10: –£–ª—É—á—à–µ–Ω–Ω—ã–π Docker Deployment (–î–µ–∫–∞–±—Ä—å 2024)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ Synology NAS
```
/volume1/docker/pwa-torserve/
‚îú‚îÄ‚îÄ .env                    # API –∫–ª—é—á–∏ (–º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
‚îú‚îÄ‚îÄ server/                 # –°–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–æ–¥ (hot-swap –±–µ–∑ rebuild)
‚îÇ   ‚îú‚îÄ‚îÄ index.js
‚îÇ   ‚îú‚îÄ‚îÄ torrent.js
‚îÇ   ‚îú‚îÄ‚îÄ jacred.js
‚îÇ   ‚îú‚îÄ‚îÄ watchdog.js
‚îÇ   ‚îú‚îÄ‚îÄ utils/doh.js
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îú‚îÄ‚îÄ data/db.json           # Persistence
‚îî‚îÄ‚îÄ downloads/             # –¢–æ—Ä—Ä–µ–Ω—Ç—ã
```

### docker-compose.synology.yml
```yaml
volumes:
  - ./server:/app/server          # Hot-swap —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞
  - ./server/utils:/app/server/utils
  - ./.env:/app/.env:ro           # –ö–æ–Ω—Ñ–∏–≥ —Å –∫–ª—é—á–∞–º–∏
  - ./data:/app/data
```

### –ò—Ç–æ–≥
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ **–±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞**
- ‚úÖ .env –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
- ‚úÖ `docker restart torserve` = –¥–µ–ø–ª–æ–π –∑–∞ 2 —Å–µ–∫—É–Ω–¥—ã

---

## üî¨ –ê–∫—Ç 11: –§–∏–Ω–∞–ª—å–Ω–∞—è –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (14 –î–µ–∫–∞–±—Ä—è 2024)

### –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å—Ç–µ—Ä—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å –Ω–∞ Android TV –±–µ–∑ VPN. –¢–µ—Å—Ç –ø–æ–∫–∞–∑—ã–≤–∞–ª –æ—à–∏–±–∫–∏ –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤.

### –†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–∞ **–¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** –≤ Settings ‚Üí "üß™ –¢–µ—Å—Ç":
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (TMDB_KEY, KP_KEY, CUSTOM_PROXY)
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –≤—Å–µ 5 –º–µ—Ç–æ–¥–æ–≤ —Å —Ç–∞–π–º–∞—É—Ç–∞–º–∏
- –í—ã–≤–æ–¥–∏—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤–≤–µ—Å—Ç–∏ –ª—é–±–æ–π —Ñ–∏–ª—å–º –¥–ª—è —Ç–µ—Å—Ç–∞

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ –±–∞–≥–∏

#### 1Ô∏è‚É£ client/.env –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª
```bash
# –ù–µ –±—ã–ª–æ —Ñ–∞–π–ª–∞ ‚Üí APK —Å–æ–±–∏—Ä–∞–ª—Å—è –±–µ–∑ –∫–ª—é—á–µ–π
VITE_TMDB_API_KEY=  # –ø—É—Å—Ç–æ–π!
```
**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω `client/.env` —Å –∫–ª—é—á–∞–º–∏, –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω APK.

#### 2Ô∏è‚É£ Custom Worker - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL —Ñ–æ—Ä–º–∞—Ç
```javascript
// –ë—ã–ª–æ: Worker –¥–æ–±–∞–≤–ª—è–ª /3/, –∞ –º—ã —Ç–æ–∂–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏ /3/
const proxyUrl = `${PROXY}/3/search/multi?...`  // ‚Üí /3/3/search/multi ‚ùå

// –°—Ç–∞–ª–æ:
const proxyUrl = `${PROXY}/search/multi?...`    // Worker –¥–æ–±–∞–≤–∏—Ç /3 ‚úÖ
```

#### 3Ô∏è‚É£ Lampa Proxy - –ª–æ–º–∞–ª—Å—è encodeURIComponent
```javascript
// –ë—ã–ª–æ:
const lampaUrl = proxy + encodeURIComponent(targetUrl)  // –õ–æ–º–∞–µ—Ç URL ‚ùå

// –°—Ç–∞–ª–æ:
const lampaUrl = `https://apn-latest.onrender.com/${targetUrl}`  // ‚úÖ
```

#### 4Ô∏è‚É£ –ö–∏–Ω–æ–ø–æ–∏—Å–∫ - –∫–ª—é—á –Ω–µ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω
```env
# –ë—ã–ª–æ:
VITE_KP_API_KEY=

# –°—Ç–∞–ª–æ:
VITE_KP_API_KEY=2a4a0808-81a3-40ae-b0d3-e11335ede616
```

### Cloudflare Worker Geolocation Block
**–ü—Ä–æ–±–ª–µ–º–∞:** TMDB –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `error 1102` (geolocation not permitted) –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö Cloudflare Edge —Å–µ—Ä–≤–µ—Ä–æ–≤.
- –° Mac (–ï–≤—Ä–æ–ø–∞): ‚úÖ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –° Android TV (–†–æ—Å—Å–∏—è): ‚ùå 403

**–ü—Ä–∏—á–∏–Ω–∞:** Cloudflare Workers –∏—Å–ø–æ–ª—å–∑—É—é—Ç IP –±–ª–∏–∂–∞–π—à–µ–≥–æ edge-—Å–µ—Ä–≤–µ—Ä–∞. TMDB –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏–∑ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤.

### –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

| # | –ú–µ—Ç–æ–¥ | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---|-------|--------|-------------|
| 1Ô∏è‚É£ | Custom Worker | ‚ùå | TMDB –≥–µ–æ–±–ª–æ–∫ –¥–ª—è RU edge |
| 2Ô∏è‚É£ | **Lampa Proxy** | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç! |
| 3Ô∏è‚É£ | CapacitorHttp | üö´ | DNS Poisoning –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º |
| 4Ô∏è‚É£ | **corsproxy.io** | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç! |
| 5Ô∏è‚É£ | **–ö–∏–Ω–æ–ø–æ–∏—Å–∫** | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç! |

### –ö–æ–¥ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
```javascript
const handleTestPoster = async () => {
    const userInput = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞:', 'Gladiator 2')
    // ...—Ç–µ—Å—Ç–∏—Ä—É–µ—Ç 5 –º–µ—Ç–æ–¥–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å —Ç–∞–π–º–∞—É—Ç–∞–º–∏...
    // ...–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏...
}
```

### –ò—Ç–æ–≥
- ‚úÖ **3 —Ä–∞–±–æ—á–∏—Ö –º–µ—Ç–æ–¥–∞** –±–µ–∑ VPN (Lampa, corsproxy, –ö–∏–Ω–æ–ø–æ–∏—Å–∫)
- ‚úÖ Fallback-—Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —Ä–∞–±–æ—á–∏–π –º–µ—Ç–æ–¥
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–ª—è troubleshooting
- ‚úÖ APK v2.7 —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å—Ç–µ—Ä–æ–≤

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      Poster.jsx                              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  1. Custom Worker ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ [–ë–ª–æ–∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ RU]              ‚îÇ
‚îÇ         ‚îÇ                                                    ‚îÇ
‚îÇ         ‚ñº                                                    ‚îÇ
‚îÇ  2. Lampa Proxy ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ apn-latest.onrender.com ‚îÄ‚îÄ‚îÄ‚ñ∫ TMDB ‚îÇ
‚îÇ         ‚îÇ                        ‚úÖ                          ‚îÇ
‚îÇ         ‚ñº                                                    ‚îÇ
‚îÇ  3. CapacitorHttp ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ [DNS Poisoning 127.0.0.1]         ‚îÇ
‚îÇ         ‚îÇ                                                    ‚îÇ
‚îÇ         ‚ñº                                                    ‚îÇ
‚îÇ  4. corsproxy.io ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ corsproxy.io ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ TMDB  ‚îÇ
‚îÇ         ‚îÇ                        ‚úÖ                          ‚îÇ
‚îÇ         ‚ñº                                                    ‚îÇ
‚îÇ  5. –ö–∏–Ω–æ–ø–æ–∏—Å–∫ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ kinopoiskapiunofficial ‚îÄ‚îÄ‚îÄ‚ñ∫ KP    ‚îÇ
‚îÇ         ‚îÇ                        ‚úÖ                          ‚îÇ
‚îÇ         ‚ñº                                                    ‚îÇ
‚îÇ  6. Gradient Fallback ‚îÄ‚îÄ‚ñ∫ –ö—Ä–∞—Å–∏–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### üèÜ –ü–æ–±–µ–¥–∞ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞!
–ü–æ—Å—Ç–µ—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–∞ Android TV –±–µ–∑ VPN —á–µ—Ä–µ–∑ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É fallback.

---

## üñºÔ∏è –ê–∫—Ç 12: –ë–∏—Ç–≤–∞ –∑–∞ –ö–∞—Ä—Ç–∏–Ω–∫–∏ –∏ –ù–∞–≤–∏–≥–∞—Ü–∏—é (–Ø–Ω–≤–∞—Ä—å 2026)

### –ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ1: –ö–∞—Ä—Ç–∏–Ω–∫–∏ (HTTP 404)
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —É—Å–ø–µ—Ö —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ (JSON), —Å–∞–º–∏ –ø–æ—Å—Ç–µ—Ä—ã (`.jpg`) –ø–µ—Ä–µ—Å—Ç–∞–ª–∏ –≥—Ä—É–∑–∏—Ç—å—Å—è.
- **–ó–µ—Ä–∫–∞–ª–∞ Lampa** (`imagetmdb.com`) –Ω–∞—á–∞–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏–ª–∏ –≤—ã–¥–∞–≤–∞—Ç—å –æ—à–∏–±–∫–∏.
- **–ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–µ—Ä–∫–∞–ª–∞** —á–µ—Ä–µ–∑ `wsrv.nl` –Ω–µ –ø–æ–º–æ–≥–∞–ª–æ (—Ç.–∫. —Å–∞–º–æ –∑–µ—Ä–∫–∞–ª–æ –ª–µ–∂–∞–ª–æ).

### –†–µ—à–µ–Ω–∏–µ: –í–æ–∑–≤—Ä–∞—Ç –∫ –ò—Å—Ç–æ–∫–∞–º ("Old Scheme") üõ°Ô∏è
–ú—ã –≤—Å–ø–æ–º–Ω–∏–ª–∏ —É—Å–ø–µ—à–Ω—ã–π –æ–ø—ã—Ç "–ê–∫—Ç–∞ 3". `wsrv.nl` ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏–π –ø—Ä–æ–∫—Å–∏, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π TMDB.
–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å *–ø–∏—Ä–∞—Ç—Å–∫–æ–µ –∑–µ—Ä–∫–∞–ª–æ*, –º—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ **–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ `image.tmdb.org`**.

**–ê–ª–≥–æ—Ä–∏—Ç–º (`tmdbClient.js`):**
1. –ü—ã—Ç–∞–µ–º—Å—è –≥—Ä—É–∑–∏—Ç—å —Å –∑–µ—Ä–∫–∞–ª Lampa (–±—ã—Å—Ç—Ä–æ).
2. –ï—Å–ª–∏ –∑–µ—Ä–∫–∞–ª–æ –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫–∏ (20 –æ—à–∏–±–æ–∫ –∑–∞ 10 —Å–µ–∫) -> **BAN**.
3. –í–∫–ª—é—á–∞–µ—Ç—Å—è **Proxy Mode**:
   - URL –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤: `https://wsrv.nl/?url=https://image.tmdb.org/t/p/w500/...`
   - `wsrv.nl` (–ï–≤—Ä–æ–ø–∞) –∑–∞–±–∏—Ä–∞–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É —É `tmdb.org` (–°–®–ê) –∏ –æ—Ç–¥–∞–µ—Ç –Ω–∞–º (–†–§).
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 100% –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–µ–∑ VPN.

### –ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ2: TV –ù–∞–≤–∏–≥–∞—Ü–∏—è üéÆ
1. **"–û–±—Ä–µ–∑–∞–Ω–Ω—ã–π –≤–µ—Ä—Ö":** –ü—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –Ω–∞ –≤–µ—Ä—Ö–Ω–∏–π —Ä—è–¥ (–¢—Ä–µ–Ω–¥—ã) –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ñ–∏–ª—å–º–∞ –æ–±—Ä–µ–∑–∞–ª—Å—è, —Ç–∞–∫ –∫–∞–∫ –±—Ä–∞—É–∑–µ—Ä —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–ª —Ä—è–¥ (`block: 'center'`).
2. **"–î—Ä–æ–∂–∞–Ω–∏–µ":** –ü–ª–∞–≤–Ω—ã–π —Å–∫—Ä–æ–ª–ª (`behavior: 'smooth'`) –≤—ã–∑—ã–≤–∞–ª –ª–∞–≥–∏ –Ω–∞ –¢–í –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–º –ø–µ—Ä–µ–ª–∏—Å—Ç—ã–≤–∞–Ω–∏–∏.
3. **–ö–Ω–æ–ø–∫–∞ "–ï—â—ë":** –ù–µ–¥–æ—Å—Ç—É–ø–Ω–∞ —Å –ø—É–ª—å—Ç–∞.

### –†–µ—à–µ–Ω–∏—è –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:
1. **Smart Top Scroll:** –ï—Å–ª–∏ —Ñ–æ–∫—É—Å –Ω–∞ **–ø–µ—Ä–≤–æ–º —Ä—è–¥—É**, –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–∫—Ä–æ–ª–ª–∏–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ `0px` (`window.scrollTo({ top: 0 })`) –∏ –æ—Ç–∫–ª—é—á–∞–µ–º —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä—è–¥–∞ (`block: 'nearest'`). –®–∞–ø–∫–∞ –≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω–∞ –∏–¥–µ–∞–ª—å–Ω–æ.
2. **Instant Scroll:** –í–∫–ª—é—á–µ–Ω —Ä–µ–∂–∏–º `behavior: 'auto'` ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ –Ω–∞–∂–∞—Ç–∏—è.
3. **Focus Logic:** –ö–Ω–æ–ø–∫–∞ "–ï—â—ë" —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞–∂–∞—Ç–∏–µ–º –í–ü–†–ê–í–û —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞.

### –ò—Ç–æ–≥ –Ø–Ω–≤–∞—Ä—è 2026: üèÜ –ü–û–õ–ù–ê–Ø –ü–û–ë–ï–î–ê
*   **–ö–∞—Ä—Ç–∏–Ω–∫–∏:** –ì—Ä—É–∑—è—Ç—Å—è –≤—Å–µ–≥–¥–∞ (Direct Mirror -> Auto-Ban -> WSRV Proxy).
*   **–ù–∞–≤–∏–≥–∞—Ü–∏—è:** –ò–¥–µ–∞–ª—å–Ω–æ –ø–ª–∞–≤–Ω–∞—è, –Ω–∏—á–µ–≥–æ –Ω–µ –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è.
*   **VPN:** –ù–µ –Ω—É–∂–µ–Ω.
