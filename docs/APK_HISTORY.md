# –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–ª–∞–¥–∫–∏ APK PWA-TorServe (Android TV)

## –û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º—ã
–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ Synology NAS, –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å (APK –Ω–∞ Android TV) –ø–µ—Ä–µ—Å—Ç–∞–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å. –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã:
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø—É–ª—å—Ç–æ–º (Focus trap).
- –í–∏–¥–µ–æ –Ω–µ –∑–∞–ø—É—Å–∫–∞–ª–æ—Å—å –≤–æ –≤–Ω–µ—à–Ω–∏—Ö –ø–ª–µ–µ—Ä–∞—Ö (Vimu, VLC, MX).
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∞–ª–æ –ø–æ—Å–ª–µ –Ω–µ—É–¥–∞—á–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è.
- –ú–µ—Ä—Ü–∞—é—â–∞—è –∞–Ω–∏–º–∞—Ü–∏—è (Pulse) —Å–±–∏–≤–∞–ª–∞ —Å —Ç–æ–ª–∫—É.
- –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞–ª–∞—Å—å –ø—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.

---

## –•—Ä–æ–Ω–æ–ª–æ–≥–∏—è –≤–µ—Ä—Å–∏–π (Debug Log)

### ‚ùå v1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –°–µ—Ä–≤–µ—Ä–∞ (–õ–æ–∂–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
*   **–ò–¥–µ—è**: –ú—ã –¥—É–º–∞–ª–∏, —á—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏—Å–ø—Ä–∞–≤–∏—Ç –ø—Ä–æ–±–ª–µ–º—ã –∫–ª–∏–µ–Ω—Ç–∞.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–µ—Ä–≤–µ—Ä –æ–±–Ω–æ–≤–∏–ª—Å—è, –Ω–æ APK –æ—Å—Ç–∞–ª—Å—è —Å—Ç–∞—Ä—ã–º. –õ–æ–≥–∏–∫–∞ –∑–∞–ø—É—Å–∫–∞ –≤–∏–¥–µ–æ "–∑–∞—à–∏—Ç–∞" –≤ APK.
*   **–í—ã–≤–æ–¥**: –ù—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞—Ç—å APK —Ñ–∞–π–ª (`app-debug.apk`).

### ‚ùå v2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UI –∏ –ü—É–ª—å—Ç–∞
*   **–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
    1.  `index.css`: –£–¥–∞–ª–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—è `.pulse-ready`, –∫–æ—Ç–æ—Ä–∞—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞–ª–∞ —Å —Ñ–æ–∫—É—Å–æ–º.
    2.  `index.css`: –£–≤–µ–ª–∏—á–µ–Ω—ã —à—Ä–∏—Ñ—Ç—ã –∏ –∫–Ω–æ–ø–∫–∏ –≤ 1.5 —Ä–∞–∑–∞ –¥–ª—è TV.
    3.  `App.jsx`: –î–æ–±–∞–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ **Back/Esc** (—Ä–∞–Ω–µ–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞).
    4.  `App.jsx`: –£–ø—Ä–æ—â–µ–Ω Intent –¥–ª—è –ø–ª–µ–µ—Ä–∞ "System".
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å—Ç–∞–ª –ª—É—á—à–µ, –Ω–æ –≤–∏–¥–µ–æ –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ –∑–∞–ø—É—Å–∫–∞–ª–æ—Å—å. –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞.

### ‚ùå v3: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (Debug Overlay)
*   **–¶–µ–ª—å**: –£–≤–∏–¥–µ—Ç—å –æ—à–∏–±–∫–∏ –Ω–∞ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–µ (—Ç–∞–∫ –∫–∞–∫ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ª–æ–≥–≥–µ—Ä–∞ –Ω–µ—Ç).
*   **–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
    1.  **–ó–µ–ª–µ–Ω–∞—è –∫–æ–Ω—Å–æ–ª—å**: –î–æ–±–∞–≤–ª–µ–Ω –æ–≤–µ—Ä–ª–µ–π –ª–æ–≥–æ–≤ –ø–æ–≤–µ—Ä—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.
    2.  **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–æ–∫—É—Å**: –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å–∏–ª—å–Ω–æ —Å—Ç–∞–≤–∏—Ç —Ñ–æ–∫—É—Å –Ω–∞ –∫–Ω–æ–ø–∫—É "PLAY".
    3.  **–§–∏–∫—Å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ —Å–±–æ—Ä–∫–∏ (–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —Å–∫–æ–±–∫–∏ –≤ JSX).
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 
    - –õ–æ–≥–∏ –ø–æ–∫–∞–∑–∞–ª–∏: `Intent execution started`, –Ω–æ –ø–ª–µ–µ—Ä –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–ª—Å—è.
    - –û—à–∏–±–æ–∫ JS –Ω–µ –±—ã–ª–æ (–∑–Ω–∞—á–∏—Ç, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–∏—Å—Ç–µ–º—ã Android).
    - –§–æ–∫—É—Å –∑–∞—Ä–∞–±–æ—Ç–∞–ª.

### ‚ùå v4: –ú–∞–Ω–∏—Ñ–µ—Å—Ç –∏ Anchor Click
*   **–ì–∏–ø–æ—Ç–µ–∑–∞**: Android 11+ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—É—Å–∫ –≤–Ω–µ—à–Ω–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –ø—Ä–æ–ø–∏—Å–∞–Ω—ã –≤ `AndroidManifest.xml`. WebView —Ç–∞–∫–∂–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç `window.location.href`.
*   **–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
    1.  `AndroidManifest.xml`: –î–æ–±–∞–≤–ª–µ–Ω —Ç–µ–≥ `<queries>`, —Ä–∞–∑—Ä–µ—à–∞—é—â–∏–π –≤–∏–¥–µ—Ç—å –ø–∞–∫–µ—Ç—ã `net.gtvbox.videoplayer` (Vimu), VLC –∏ MX Player.
    2.  `App.jsx`: –ò–∑–º–µ–Ω–µ–Ω –º–µ—Ç–æ–¥ –∑–∞–ø—É—Å–∫–∞. –í–º–µ—Å—Ç–æ `window.location.href = ...` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∏–º—É–ª—è—Ü–∏—è –∫–ª–∏–∫–∞ –ø–æ —Å—Å—ã–ª–∫–µ (`<a href="..." click()>`).
    3.  –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ **Copy Link** –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í–∏–¥–µ–æ –≤—Å–µ –µ—â–µ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–ª–æ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### ‚úÖ v5: –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –∏ UX (–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è)
*   **–ì–∏–ø–æ—Ç–µ–∑–∞**: –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç –∏–Ω—Ç–µ–Ω—Ç–æ–≤ (`intent:scheme:http`) —É—Å—Ç–∞—Ä–µ–ª –¥–ª—è Chrome WebView. –ù—É–∂–µ–Ω —Ñ–æ—Ä–º–∞—Ç `intent://...#Intent;scheme=http`.
*   **–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
    1.  **–°–∫—Ä—ã—Ç—ã–π –≤–≤–æ–¥**: –°—Ç—Ä–æ–∫–∞ Magnet Link —Ç–µ–ø–µ—Ä—å —Å–∫—Ä—ã—Ç–∞ –∑–∞ –∫–Ω–æ–ø–∫–æ–π "‚ûï", —á—Ç–æ–±—ã –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –Ω–µ –≤—ã—Å–∫–∞–∫–∏–≤–∞–ª–∞ —Å–∞–º–∞.
    2.  **Modern Intent Scheme**: –°—Å—ã–ª–∫–∞ –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç `intent://<url>#Intent;scheme=http;package=...;end`.
    3.  **Fallback**: –ï—Å–ª–∏ –∫–ª–∏–∫ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, —á–µ—Ä–µ–∑ 500–º—Å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `window.open(..., '_top')`.
*   **–°—Ç–∞—Ç—É—Å**: –û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.

---

## –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è)
### ‚ùå v6: System Target & Config Fixes
*   **–ì–∏–ø–æ—Ç–µ–∑–∞**: `window.open` –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è WebView, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω —Ç–∞—Ä–≥–µ—Ç `_system`. –¢–∞–∫–∂–µ –Ω—É–∂–Ω—ã Explicit Permissions –≤ `capacitor.config.json` –∏ `AndroidManifest`.
*   **–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
    1.  `AndroidManifest.xml`: –î–æ–±–∞–≤–ª–µ–Ω `com.brouken.player` –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω —Å–ø–∏—Å–æ–∫ `<queries>`.
    2.  `capacitor.config.json`: –î–æ–±–∞–≤–ª–µ–Ω `allowNavigation: ["192.168.1.70", "*"]`.
    3.  `App.jsx`: –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `window.open(vimuIntent, '_system')`.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –õ–æ–≥–∏ –ø–æ–∫–∞–∑–∞–ª–∏ `Window.open(_system) executed`, –Ω–æ –≤–∏–∑—É–∞–ª—å–Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ. –¢–µ–ª–µ–≤–∏–∑–æ—Ä –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª –∑–∞–ø—Ä–æ—Å.

### ‚ùå v7: Native App.openUrl (–°–±–æ–π API)
*   **–ì–∏–ø–æ—Ç–µ–∑–∞**: –ù—É–∂–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–π—Ç–∏ –æ—Ç –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ (`window.open`) –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω—ã–π –∫–æ–¥ Capacitor (`App.openUrl`), —á—Ç–æ–±—ã –ø—Ä–æ–±–∏—Ç—å –ø–µ—Å–æ—á–Ω–∏—Ü—É WebView.
*   **–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
    1.  –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω `import { App } from '@capacitor/app'`.
    2.  –ó–∞–º–µ–Ω–µ–Ω –≤—ã–∑–æ–≤ –Ω–∞ `await App.openUrl({ url: intent... })`.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –û—à–∏–±–∫–∞ `App.openUrl() is not implemented`. –í—ã—è—Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ –≤ **Capacitor 6** —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –±—ã–ª —É–¥–∞–ª–µ–Ω/–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω.

### ‚ùå v8: Browser Plugin (–ü—Ä–æ–≤–∞–ª)
*   **–ì–∏–ø–æ—Ç–µ–∑–∞**: –í Capacitor 6 –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Å—Å—ã–ª–æ–∫ (–≤–∫–ª—é—á–∞—è deep links/intents) –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–ª–∞–≥–∏–Ω `@capacitor/browser`.
*   **–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
    1.  –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω `import { Browser } from '@capacitor/browser'`.
    2.  –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `Browser.open({ url: intentUrl })`.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –û—à–∏–±–∫–∞ `Unable to open URL` –¥–ª—è `intent://`. –ü–ª–∞–≥–∏–Ω Browser —É–º–µ–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ HTTP/HTTPS.

### ‚úÖ v9: Nuclear Option (Native Bridge) - –ü–û–ë–ï–î–ê! üèÜ
*   **–ì–∏–ø–æ—Ç–µ–∑–∞**: –ù–∏–∫–∞–∫–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ JS-–º–µ—Ç–æ–¥—ã (`window.open`, `Browser.open`) –Ω–µ —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏ WebView –Ω–∞ Android TV. –ù—É–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å `startActivity(Intent)` –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ Java-–∫–æ–¥–∞.
*   **–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
    1.  **Java**: –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `TVPlayer.java` (Native Plugin).
    2.  **Bridge**: –ü–ª–∞–≥–∏–Ω –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `MainActivity.java`.
    3.  **JS**: –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤—ã–∑—ã–≤–∞–µ—Ç `TVPlayer.play({ url, package })`.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: **–£–°–ü–ï–•**. –í–∏–¥–µ–æ –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å –≤–æ –≤–Ω–µ—à–Ω–µ–º –ø–ª–µ–µ—Ä–µ (Vimu). –≠—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–±–æ—á–µ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è Ugoos/Android TV.

---

## –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è)
**Native Bridge (`TVPlayer.java`) —É—Ç–≤–µ—Ä–∂–¥–µ–Ω –∫–∞–∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.**

–î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏:
1.  –£–¥–∞–ª–∏—Ç—å `DebugConsole` (–∑–µ–ª–µ–Ω—ã–µ –ª–æ–≥–∏) –∏–∑ `App.jsx`.
2.  –°–æ–±—Ä–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π `app-release.apk`.
3.  –û–±–Ω–æ–≤–∏—Ç—å `FULL_PROJECT_CODE.md`, –¥–æ–±–∞–≤–∏–≤ –∫–æ–¥ `TVPlayer.java`.

