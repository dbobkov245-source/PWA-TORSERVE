MASTER ROADMAP: PWA-TorServe v3.0.1 (Stabilization)
–°—Ç–∞—Ç—É—Å: üü¢ –£–¢–í–ï–†–ñ–î–ï–ù–û –ö –ò–°–ü–û–õ–ù–ï–ù–ò–Æ –î–∞—Ç–∞: 26.01.2026 –§–∏–ª–æ—Å–æ—Ñ–∏—è: ¬´–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ¬ª. –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ —Å–ª–æ–º–∞–Ω–æ, –Ω–µ —Ç—Ä–æ–≥–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —è–¥—Ä–æ.

üõ†Ô∏è –ü–†–ï–î–í–ê–†–ò–¢–ï–õ–¨–ù–´–ô –≠–¢–ê–ü
–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

Bash

npm install magnet-uri
(–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è FIX-03: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤)

üî¥ –≠–¢–ê–ü 1: BACKEND (–°–µ—Ä–¥—Ü–µ —Å–∏—Å—Ç–µ–º—ã)
–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –ë–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª.

ü©π FIX-01: Torrent Kickstart (–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∞—Ä—Ç)
–ü—Ä–æ–±–ª–µ–º–∞: –¢–æ—Ä—Ä–µ–Ω—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è, –Ω–æ —Å—Ç–æ–∏—Ç –Ω–∞ 0%. –î–≤–∏–∂–æ–∫ torrent-stream –ª–µ–Ω–∏–≤—ã–π: –æ–Ω –∂–¥–µ—Ç –∫–æ–º–∞–Ω–¥—ã select, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç –≤ –∫–æ–¥–µ. –£–ª—É—á—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, —á—Ç–æ–±—ã –≤—ã–±–∏—Ä–∞—Ç—å —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π –≤–∏–¥–µ–æ—Ñ–∞–π–ª (–æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∏–ª—å–º), –∞ –Ω–µ —Å—ç–º–ø–ª—ã. –§–∞–π–ª: server/torrent.js

JavaScript

// –í–Ω—É—Ç—Ä–∏ engine.on('ready', ...):

// [PATCH] Force selection for new torrents
if (!isFrozenResume) {
    // 1. –§–∏–ª—å—Ç—Ä—É–µ–º –≤–∏–¥–µ–æ—Ñ–∞–π–ª—ã
    const videoFiles = engine.files.filter(f => /\.(mp4|mkv|avi|mov)$/i.test(f.name));
    
    // 2. –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —Ä–∞–∑–º–µ—Ä—É (–æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É), —á—Ç–æ–±—ã –Ω–µ –Ω–∞—á–∞—Ç—å –∫–∞—á–∞—Ç—å —Å—ç–º–ø–ª
    videoFiles.sort((a, b) => b.length - a.length);

    const mainFile = videoFiles[0];

    if (mainFile) {
        console.log(`[Torrent] üöÄ Kickstart download: ${mainFile.name} (${(mainFile.length / 1024 / 1024).toFixed(2)} MB)`);
        mainFile.select(); // <--- –ö–õ–Æ–ß–ï–í–ê–Ø –ö–û–ú–ê–ù–î–ê
    }
}
ü©π FIX-02: Search Providers Unblock (–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–∏—Å–∫–∞)
–ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã (RuTracker, TorLook) –æ—Ç–∫–ª—é—á–∞—é—Ç —Å–∞–º–∏ —Å–µ–±—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ, –µ—Å–ª–∏ –Ω–µ—Ç –ª–æ–≥–∏–Ω–∞/–ø–∞—Ä–æ–ª—è. –û—à–∏–±–æ–∫ –Ω–µ—Ç, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–æ–∂–µ –Ω–µ—Ç. –§–∞–π–ª: server/providers/RuTrackerProvider.js (–∏ TorLook)

JavaScript

// –í constructor():
if (!this.login || !this.password) {
    // ‚ùå –£–î–ê–õ–ò–¢–¨: this.enabled = false
    
    // ‚úÖ –û–°–¢–ê–í–ò–¢–¨ –¢–û–õ–¨–ö–û –õ–û–ì:
    console.warn('[RuTracker] Auth missing. Provider stays ACTIVE but might fail with 401.');
}
ü©π FIX-03: Smart Deduplication (–£–º–Ω–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è)
–ü—Ä–æ–±–ª–µ–º–∞: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–≤–∏–∂–∫–æ–≤ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≥–æ –∂–µ —Ñ–∏–ª—å–º–∞ —Å –¥—Ä—É–≥–æ–≥–æ –∑–µ—Ä–∫–∞–ª–∞ (—Ä–∞–∑–Ω—ã–µ magnet-—Å—Å—ã–ª–∫–∏). –£–ª—É—á—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ö–µ—à–∞. –§–∞–π–ª: server/torrent.js

JavaScript

import { decode as decodeMagnet } from 'magnet-uri';

// –í –Ω–∞—á–∞–ª–µ addTorrent(magnetURI):
let infoHash;
try {
    const parsed = decodeMagnet(magnetURI);
    // –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ö–µ—à–∞ (—Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ –±—É—Ñ–µ—Ä)
    const hashRaw = parsed.infoHash || parsed.infoHashBuffer?.toString('hex');
    
    if (!hashRaw) throw new Error('No infoHash found in magnet');
    
    infoHash = hashRaw.toLowerCase();
} catch (e) {
    console.error('[Torrent] Invalid magnet:', e.message);
    return reject(new Error('Invalid magnet URI'));
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –•–≠–®–£ (–Ω–∞–¥–µ–∂–Ω–æ)
if (engines.has(infoHash)) {
    console.log(`[Torrent] ‚ôªÔ∏è Engine reused for hash: ${infoHash}`);
    return resolve(formatEngine(engines.get(infoHash)));
}
üü† –≠–¢–ê–ü 2: FRONTEND NAVIGATION (–ú–æ—Å—Ç—ã –∏ –õ–æ–≤—É—à–∫–∏)
–ü–∞—Ç—á–∏ –ø–æ–≤–µ—Ä—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ª–æ–≥–∏–∫–∏. –ù–µ –º–µ–Ω—è–µ–º App.jsx.

üî™ NAV-01: Header Bridge (–ú–æ—Å—Ç –≤ –•–µ–¥–µ—Ä)
–ü—Ä–æ–±–ª–µ–º–∞: –†–∞–∑—Ä—ã–≤ —Ñ–æ–∫—É—Å–∞ –º–µ–∂–¥—É Fixed Header –∏ Scrollable Grid. –§–∞–π–ª: client/src/components/HomePanel.jsx

JavaScript

// –í useEffect (mount):
const handleBridgeNav = (e) => {
    if (e.key === 'ArrowUp') {
        const active = document.activeElement;
        const headerZone = document.getElementById('header-zone'); // –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ ID –µ—Å—Ç—å —É —Ö–µ–¥–µ—Ä–∞
        
        // –ï—Å–ª–∏ —Ñ–æ–∫—É—Å –ù–ï –≤ —Ö–µ–¥–µ—Ä–µ (–∑–Ω–∞—á–∏—Ç –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ), –∏ –∂–º–µ–º –í–≤–µ—Ä—Ö
        if (!headerZone?.contains(active)) {
             const searchBtn = document.getElementById('btn-search'); // –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ ID –µ—Å—Ç—å —É –∫–Ω–æ–ø–∫–∏
             if (searchBtn) {
                 e.preventDefault(); // –û—Ç–º–µ–Ω–∞ spatial –ª–æ–≥–∏–∫–∏
                 searchBtn.focus();  // –ü—Ä—è–º–æ–π –ø—Ä—ã–∂–æ–∫
             }
        }
    }
};
window.addEventListener('keydown', handleBridgeNav);
return () => window.removeEventListener('keydown', handleBridgeNav);
üî™ NAV-02: Modal Focus Trap (–õ–æ–≤—É—à–∫–∞ —Ñ–æ–∫—É—Å–∞)
–ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ç–µ—Ä—è —Ñ–æ–∫—É—Å–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏/–∑–∞–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª–æ–∫. –§–∞–π–ª: client/src/components/DiagnosticsPanel.jsx

JavaScript

useEffect(() => {
    const prevFocus = document.activeElement; // 1. –ó–∞–ø–æ–º–Ω–∏—Ç—å —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞
    
    // 2. –ó–∞—Ö–≤–∞—Ç–∏—Ç—å —Ñ–æ–∫—É—Å (–∏—â–µ–º –ø–µ—Ä–≤—É—é –∫–Ω–æ–ø–∫—É)
    const firstFocusable = document.querySelector('.modal-content button');
    if (firstFocusable) firstFocusable.focus();

    return () => {
        // 3. –í–µ—Ä–Ω—É—Ç—å —Ñ–æ–∫—É—Å –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ (–ö–†–ò–¢–ò–ß–ù–û)
        if (prevFocus?.focus) prevFocus.focus();
    };
}, []);
üü° –≠–¢–ê–ü 3: RESILIENCE (–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å)
üõ°Ô∏è STAB-01: Circuit Breaker Reset (–°–±—Ä–æ—Å –æ—à–∏–±–æ–∫)
–ü—Ä–æ–±–ª–µ–º–∞: –í–µ—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –ø–æ—Å–ª–µ 3-—Ö –Ω–µ—É–¥–∞—á. –§–∞–π–ª: server/aggregator.js

JavaScript

// –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é:
setInterval(() => {
    for (const [name, state] of providerState.entries()) {
        // –ï—Å–ª–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä "–ª–µ–∂–∏—Ç", –¥–∞–µ–º –µ–º—É —à–∞–Ω—Å —Ä–∞–∑ –≤ 5 –º–∏–Ω—É—Ç
        if (state.failures > 0) {
            console.log(`[Circuit] Resetting failure count for ${name}`);
            state.failures = 0;
            // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: state.circuitOpen = false;
        }
    }
}, 5 * 60 * 1000);
‚õî STOP LIST (–°—Ç—Ä–æ–≥–∏–µ –∑–∞–ø—Ä–µ—Ç—ã v3.0.1)
‚ùå –ù–∏–∫–∞–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ App.jsx. –ö–æ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–∫—Ä–∞—Å–∏–≤—ã–º, –Ω–æ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç. –õ—é–±–æ–µ "—É–ª—É—á—à–µ–Ω–∏–µ" —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–µ–π—á–∞—Å —É–±—å–µ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏—é.

‚ùå –ù–µ –º–µ–Ω—è—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏. –ì–∏–±—Ä–∏–¥ useTVNavigation –∏ useSpatialNavigation –æ—Å—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å.

‚ùå –ù–µ —Ç—Ä–æ–≥–∞—Ç—å –ª–æ–≥–∏–∫—É TMDB Proxy. –¶–µ–ø–æ—á–∫–∞ —Ñ–æ–ª–±–µ–∫–æ–≤ (Worker -> Proxy) –Ω–µ–ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–Ω–∞.

‚úÖ CHECKLIST –ü–†–ò–ï–ú–ö–ò
Kickstart Test:

–î–æ–±–∞–≤–∏—Ç—å —Ç–æ—Ä—Ä–µ–Ω—Ç (—Ñ–∏–ª—å–º/—Å–µ—Ä–∏–∞–ª).

–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤ –ª–æ–≥–∞—Ö –µ—Å—Ç—å: [Torrent] üöÄ Kickstart download.

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—ã–±—Ä–∞–Ω —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π —Ñ–∞–π–ª.

Authless Search Test:

–£–¥–∞–ª–∏—Ç—å –ª–æ–≥–∏–Ω RuTracker –∏–∑ .env.

–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–∏–ª–∏ –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏), –Ω–æ –Ω–µ –ø—É—Å—Ç–æ—Ç–∞.

TV Navigation Test:

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã—Ö–æ–¥ –∏–∑ —Å–ø–∏—Å–∫–∞ —Ñ–∏–ª—å–º–æ–≤ –≤–≤–µ—Ä—Ö (–Ω–∞ –∫–Ω–æ–ø–∫—É –ü–æ–∏—Å–∫–∞).

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–æ–∑–≤—Ä–∞—Ç —Ñ–æ–∫—É—Å–∞ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.

# üóìÔ∏è SESSION LOG: 26.01.2026

## üéØ –¶–µ–ª–∏ —Å–µ—Å—Å–∏–∏
1.  **Backend Fixes**: Kickstart download, Smart Deduplication, Search Providers Fix. (‚úÖ –í–´–ü–û–õ–ù–ï–ù–û)
2.  **Frontend Navigation**: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É "–º–µ—Ä—Ç–≤—ã—Ö –∑–æ–Ω" (Search / Magnet / Diagnostics) –¥–ª—è –ø—É–ª—å—Ç–∞. (‚ùå –ù–ï–£–î–ê–ß–ê)

## üèóÔ∏è –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ (Backend)
–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∏–∫—Å—ã –±—ç–∫–µ–Ω–¥–∞ —É—Å–ø–µ—à–Ω–æ –≤–Ω–µ–¥—Ä–µ–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã:
*   `server/torrent.js`: –î–æ–±–∞–≤–ª–µ–Ω `mainFile.select()` (Kickstart) –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ magnet-—Ö–µ—à–∞ (Deduplication).
*   `server/providers`: –û—Ç–∫–ª—é—á–µ–Ω–∞ —Å–∞–º–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –±–µ–∑ Auth.
*   `server/aggregator.js`: –î–æ–±–∞–≤–ª–µ–Ω —Å–±—Ä–æ—Å Circuit Breaker —Ä–∞–∑ –≤ 5 –º–∏–Ω—É—Ç.

## üöß –ë–æ—Ä—å–±–∞ —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π (Frontend)
–ë—ã–ª–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç–æ 5 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –æ–∂–∏–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ Top Bar –¥–ª—è –ø—É–ª—å—Ç–∞. –í—Å–µ –Ω–µ—É–¥–∞—á–Ω—ã.

### 1. –ü–æ–ø—ã—Ç–∫–∞ "Smart Focus"
*   **–ò–¥–µ—è**: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ñ–æ–∫—É—Å (`requestAnimationFrame`) –Ω–∞ –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ –∑–æ–Ω—É.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ö–æ–Ω—Ñ–ª–∏–∫—Ç. `useEffect` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ—Ä–µ–Ω–¥–µ—Ä, –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—è —Ñ–æ–∫—É—Å –∏ –Ω–µ –¥–∞–≤–∞—è —É–π—Ç–∏ —Å –∫–Ω–æ–ø–∫–∏.

### 2. –ü–æ–ø—ã—Ç–∫–∞ "Passive Anchor"
*   **–ò–¥–µ—è**: –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä—ã—Ç—ã–π —è–∫–æ—Ä—å `tabIndex="-1"`, —á—Ç–æ–±—ã –æ–Ω –Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–ª —Ñ–æ–∫—É—Å.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –§–æ–∫—É—Å –ø—Ä–æ—Å—Ç–æ —Å—Ç–∞–ª –ø–∞–¥–∞—Ç—å –≤ –Ω–∏–∫—É–¥–∞ (body), —Ç–∞–∫ –∫–∞–∫ arbiter –Ω–µ –Ω–∞—Ö–æ–¥–∏–ª –Ω–∏—á–µ–≥–æ –¥—Ä—É–≥–æ–≥–æ.

### 3. –ü–æ–ø—ã—Ç–∫–∞ "Spatial Only"
*   **–ò–¥–µ—è**: –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä—É—á–Ω—ã—Ö `onKeyDown` –∏ `autoFocus`. –ß–∏—Å—Ç–∞—è —Ä–∞–±–æ—Ç–∞ `useSpatialArbiter`.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ Grid. –ö–Ω–æ–ø–∫–∏ –≤ —Ö–µ–¥–µ—Ä–µ (Search/Magnet) –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º—ã, —Ç–∞–∫ –∫–∞–∫ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥—Ä—É–≥–æ–º DOM-–∫–æ–Ω—Ç–µ–∫—Å—Ç–µ (–≤–Ω–µ —Å–∫—Ä–æ–ª–ª–∞), –∏ –¥–≤–∏–∂–æ–∫ (LRUD) –Ω–µ –º–æ–∂–µ—Ç –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø—É—Ç—å Vector/Euclidean.

### 4. –ü–æ–ø—ã—Ç–∫–∞ "Section Transitions"
*   **–ò–¥–µ—è**: –†—É—á–Ω—ã–µ –º–æ—Å—Ç—ã. `onKeyDown(ArrowUp)` –Ω–∞ Grid -> Focus Header.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –†–∞–±–æ—Ç–∞–µ—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ. –§–æ–∫—É—Å –ø—Ä—ã–≥–∞–µ—Ç, –Ω–æ —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –æ–±—Ä–∞—Ç–Ω–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏.

### 5. –ü–æ–ø—ã—Ç–∫–∞ "Master Toolbar" (–¢–µ–∫—É—â–∞—è)
*   **–ò–¥–µ—è**: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –í–°–ï–• –∫–Ω–æ–ø–æ–∫ (Continue, Search, Magnet, Categories) –≤ –æ–¥–∏–Ω `flex`-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.
*   **–ì–∏–ø–æ—Ç–µ–∑–∞**: –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç, —Ç–æ –∏ —Å–æ—Å–µ–¥–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –∑–∞—Ä–∞–±–æ—Ç–∞—é—Ç.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚ùå –§–æ–∫—É—Å –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –Ω–∞ Search/Magnet.
*   **–¢–µ–∫—É—â–∏–π —Å–∏–º–ø—Ç–æ–º**: –ö–Ω–æ–ø–∫–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –µ—Å—Ç—å, –Ω–æ Spatial Engine –∏—Ö –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç, –ø—Ä–æ—Å–∫–∞–∫–∏–≤–∞—è —Å—Ä–∞–∑—É –Ω–∞ Categories –∏–ª–∏ –æ—Å—Ç–∞–≤–∞—è—Å—å –≤ Grid.

## üîÆ –ü–ª–∞–Ω –Ω–∞ –∑–∞–≤—Ç—Ä–∞
–ü—Ä–æ–±–ª–µ–º–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è: **–ö–æ–Ω—Ñ–ª–∏–∫—Ç React-—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∏ Spatial Graph**.
–í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–∏ —Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–µ—Ä–µ—Å–æ–∑–¥–∞—é—Ç—Å—è, –∏ `ref` —Ç–µ—Ä—è–µ—Ç —Å–≤—è–∑—å —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–º —É–∑–ª–æ–º.

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1.  –í–µ—Ä–Ω—É—Ç—å `App.jsx` –∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é (–æ—Ç–∫–∞—Ç–∏—Ç—å "Master Toolbar", –µ—Å–ª–∏ –æ–Ω –ª–æ–º–∞–µ—Ç UX).
2.  –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å `useSpatialItem` ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, –æ–Ω –Ω–µ —É—Å–ø–µ–≤–∞–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —É–∑–ª—ã –ø—Ä–∏ —Å–º–µ–Ω–µ `activeView`.
3.  –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å—Ç–∞—Ç–∏—á–Ω—É—é** –≤–µ—Ä—Å—Ç–∫—É —Ö–µ–¥–µ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ `activeView` (–≤—ã–Ω–µ—Å—Ç–∏ –∏–∑ `if (activeView === 'list')`).